/**
 * MOBILE-SPECIFIC FIXES
 * Ensures flawless mobile experience
 */

/* ============================================
   PREVENT ZOOM ON INPUT FOCUS (iOS)
   ============================================ */
@media (max-width: 768px) {
  input[type="text"],
  input[type="email"],
  input[type="password"],
  input[type="search"],
  input[type="tel"],
  input[type="url"],
  input[type="number"],
  textarea,
  select {
    font-size: 16px !important; /* Prevents iOS zoom */
  }
}

/* ============================================
   FIX VIEWPORT HEIGHT ON MOBILE
   ============================================ */
.min-h-screen {
  min-height: 100vh;
  min-height: 100dvh; /* Dynamic viewport height */
}

.h-screen {
  height: 100vh;
  height: 100dvh;
}

/* ============================================
   FIX SAFE AREA INSETS (iPhone X+)
   ============================================ */
@supports (padding: max(0px)) {
  body {
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }
  
  .safe-area-bottom {
    padding-bottom: env(safe-area-inset-bottom);
  }
  
  .safe-area-top {
    padding-top: env(safe-area-inset-top);
  }
}

/* ============================================
   FIX TOUCH SCROLLING
   ============================================ */
@media (max-width: 768px) {
  html,
  body {
    -webkit-overflow-scrolling: touch;
    overscroll-behavior-y: none;
    overscroll-behavior-x: none;
  }
  
  /* Prevent pull-to-refresh */
  body {
    overscroll-behavior: none;
  }
}

/* ============================================
   FIX BUTTON TAP HIGHLIGHT
   ============================================ */
button,
a,
[role="button"],
[onclick] {
  -webkit-tap-highlight-color: rgba(0, 255, 136, 0.1);
  -webkit-touch-callout: none;
}

/* ============================================
   FIX TEXT SELECTION
   ============================================ */
@media (max-width: 768px) {
  /* Allow text selection in content areas */
  p,
  span,
  div[class*="content"],
  div[class*="text"],
  pre,
  code {
    -webkit-user-select: text;
    user-select: text;
  }
  
  /* Prevent selection in UI elements */
  button,
  a,
  nav,
  header,
  [role="button"] {
    -webkit-user-select: none;
    user-select: none;
  }
}

/* ============================================
   FIX MODAL SCROLLING ON MOBILE
   ============================================ */
@media (max-width: 768px) {
  [role="dialog"],
  .modal {
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: contain;
  }
  
  /* Prevent body scroll when modal is open */
  body.modal-open {
    overflow: hidden;
    position: fixed;
    width: 100%;
  }
}

/* ============================================
   FIX DROPDOWN POSITIONING ON MOBILE
   ============================================ */
@media (max-width: 768px) {
  [role="menu"],
  [role="listbox"],
  .dropdown-menu {
    position: fixed !important;
    max-height: 80vh;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
  }
}

/* ============================================
   FIX LANDSCAPE MODE
   ============================================ */
@media (max-height: 500px) and (orientation: landscape) {
  /* Reduce padding in landscape */
  .py-12 { padding-top: 1.5rem !important; padding-bottom: 1.5rem !important; }
  .py-16 { padding-top: 2rem !important; padding-bottom: 2rem !important; }
  .py-20 { padding-top: 2.5rem !important; padding-bottom: 2.5rem !important; }
  
  /* Compact navbar */
  nav,
  header {
    min-height: 56px !important;
  }
  
  /* Smaller text */
  h1 { font-size: 1.75rem !important; }
  h2 { font-size: 1.5rem !important; }
}

/* ============================================
   FIX STICKY ELEMENTS ON MOBILE
   ============================================ */
@media (max-width: 768px) {
  .sticky,
  [class*="sticky"] {
    position: -webkit-sticky;
    position: sticky;
  }
}

/* ============================================
   FIX FLEXBOX ISSUES ON MOBILE
   ============================================ */
@media (max-width: 768px) {
  .flex-col-mobile {
    flex-direction: column !important;
  }
  
  .flex-wrap-mobile {
    flex-wrap: wrap !important;
  }
}

/* ============================================
   FIX GRID ISSUES ON MOBILE
   ============================================ */
@media (max-width: 768px) {
  .grid-cols-2,
  .grid-cols-3,
  .grid-cols-4 {
    grid-template-columns: repeat(1, 1fr) !important;
  }
  
  .gap-8 { gap: 1rem !important; }
  .gap-6 { gap: 0.75rem !important; }
}

/* ============================================
   FIX IMAGE RENDERING ON MOBILE
   ============================================ */
@media (max-width: 768px) {
  img {
    max-width: 100%;
    height: auto;
    image-rendering: -webkit-optimize-contrast;
  }
}

/* ============================================
   FIX VIDEO PLAYBACK ON MOBILE
   ============================================ */
@media (max-width: 768px) {
  video {
    max-width: 100%;
    height: auto;
  }
}

/* ============================================
   FIX FORM ELEMENTS ON MOBILE
   ============================================ */
@media (max-width: 768px) {
  input,
  textarea,
  select {
    -webkit-appearance: none;
    appearance: none;
    border-radius: 0.5rem;
  }
  
  /* Fix iOS rounded corners */
  input[type="text"],
  input[type="email"],
  input[type="password"],
  input[type="search"] {
    -webkit-border-radius: 0.5rem;
  }
}

/* ============================================
   FIX HORIZONTAL SCROLL
   ============================================ */
html,
body {
  overflow-x: hidden;
  max-width: 100vw;
}

* {
  max-width: 100%;
}

/* ============================================
   FIX WEBKIT AUTOFILL
   ============================================ */
input:-webkit-autofill,
input:-webkit-autofill:hover,
input:-webkit-autofill:focus,
input:-webkit-autofill:active {
  -webkit-box-shadow: 0 0 0 30px rgba(0, 0, 0, 0.8) inset !important;
  -webkit-text-fill-color: white !important;
}

/* ============================================
   FIX FOCUS OUTLINE ON MOBILE
   ============================================ */
@media (max-width: 768px) {
  *:focus {
    outline: 2px solid rgba(0, 255, 136, 0.5);
    outline-offset: 2px;
  }
  
  *:focus:not(:focus-visible) {
    outline: none;
  }
}

/* ============================================
   FIX LOADING STATES ON MOBILE
   ============================================ */
@media (max-width: 768px) {
  .loading,
  [data-loading="true"] {
    pointer-events: none;
    opacity: 0.6;
  }
}

/* ============================================
   FIX TRANSITIONS ON MOBILE
   ============================================ */
@media (max-width: 768px) {
  * {
    transition-duration: 0.2s !important;
  }
  
  /* Disable hover effects on touch devices */
  @media (hover: none) {
    *:hover {
      transform: none !important;
    }
  }
}

/* ============================================
   FIX Z-INDEX ISSUES
   ============================================ */
.navbar,
header {
  z-index: 1000;
}

.modal,
[role="dialog"] {
  z-index: 9999;
}

.dropdown,
[role="menu"] {
  z-index: 9998;
}

/* ============================================
   FIX PERFORMANCE ON LOW-END DEVICES
   ============================================ */
@media (max-width: 480px) {
  /* Disable expensive effects */
  .backdrop-blur-xl,
  .backdrop-blur-lg,
  .backdrop-blur-md {
    backdrop-filter: blur(5px) !important;
  }
  
  /* Simplify shadows */
  .shadow-2xl,
  .shadow-xl {
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3) !important;
  }
}

/* ============================================
   FIX ACCESSIBILITY
   ============================================ */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
  }
}

/* ============================================
   FIX DARK MODE
   ============================================ */
@media (prefers-color-scheme: dark) {
  html {
    color-scheme: dark;
  }
}

/* ============================================
   FIX PRINT
   ============================================ */
@media print {
  nav,
  footer,
  .no-print {
    display: none !important;
  }
  
  * {
    background: white !important;
    color: black !important;
  }
}
